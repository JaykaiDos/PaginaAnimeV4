<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ‘‘ Modo Supervivencia - Rey de la Colina</title>
  
  <!-- SEO -->
  <meta name="description" content="Modo Supervivencia: Â¿CuÃ¡ntos rivales puede vencer tu anime favorito en atributos aleatorios?">
  
    <!-- Icono de las pestaÃ±as -->
<link rel="icon" type="image/png" href="../Image/icon.png">
<link rel="apple-touch-icon" href="../Image/icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../Image/icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="../Image/icon.png">

  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/anime-metrics.css">
</head>
<body>

  <!-- ============================================
       HEADER
       ============================================ -->
  <header class="main-header">
    <div class="container">
      <h1 class="page-title">ğŸ‘‘ Modo Supervivencia ğŸ‘‘</h1>
      <p class="page-subtitle">Rey de la Colina - Â¿CuÃ¡ntos rivales puede vencer tu anime?</p>
      <nav class="header-nav">
        <a href="../index.html" class="back-link">â† Volver al Hub</a>
        <a href="search.html" class="back-link">ğŸ” BÃºsqueda</a>
      </nav>
    </div>
  </header>

  <!-- ============================================
       SETUP SCREEN (ConfiguraciÃ³n Inicial)
       ============================================ -->
  <section id="setupScreen" class="screen active">
    <div class="container">
      <div class="setup-card">
        <h2 class="section-title">âš™ï¸ ConfiguraciÃ³n del Gauntlet</h2>
        
        <!-- Fuente de Datos -->
        <div class="setup-group">
          <label class="setup-label">
            <span class="label-icon">ğŸ“Š</span>
            <span class="label-text">Fuente de Datos:</span>
          </label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="dataSource" value="season" checked>
              <span class="radio-custom"></span>
              <span class="radio-text">Temporada EspecÃ­fica</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="dataSource" value="favorites">
              <span class="radio-custom"></span>
              <span class="radio-text">Mis Favoritos</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="dataSource" value="global">
              <span class="radio-custom"></span>
              <span class="radio-text">Global (Todos)</span>
            </label>
          </div>
        </div>

        <!-- Selector de Temporada -->
        <div class="setup-group" id="seasonSelectorGroup">
          <label class="setup-label">
            <span class="label-icon">ğŸ“…</span>
            <span class="label-text">Selecciona Temporada:</span>
          </label>
          <select id="seasonSelector" class="setup-select">
            <option value="">Cargando temporadas...</option>
          </select>
        </div>

        <!-- Info Box -->
        <div class="info-box">
          <p>ğŸ‘‘ <strong>Â¿CÃ³mo funciona el Modo Supervivencia?</strong></p>
          <p><strong>El CampeÃ³n</strong> se mantiene en pantalla y debe defender su puesto contra <strong>Aspirantes</strong> que llegan constantemente.</p>
          <p>ğŸ° Cada nuevo duelo tiene un <strong>atributo aleatorio</strong>. Si el CampeÃ³n pierde, el Aspirante toma su lugar.</p>
          <p>ğŸ† Â¡El objetivo es lograr la racha mÃ¡s larga posible!</p>
        </div>

        <!-- BotÃ³n Iniciar -->
        <button id="startSessionBtn" class="btn btn-primary btn-large">
          ğŸš€ Iniciar Gauntlet
        </button>
      </div>
    </div>
  </section>

  <!-- ============================================
       GAUNTLET SCREEN (Modo Supervivencia)
       ============================================ -->
  <section id="gauntletScreen" class="screen">
    <div class="container-gauntlet">
      
      <!-- Sidebar de EstadÃ­sticas -->
      <aside class="stats-sidebar">
        <h3 class="sidebar-title">ğŸ“Š EstadÃ­sticas Live</h3>
        
        <!-- Racha Actual -->
        <div class="current-streak-box">
          <div class="streak-label">ğŸ”¥ Racha Actual</div>
          <div class="streak-value" id="currentStreak">0</div>
          <div class="streak-champion" id="streakChampion">-</div>
        </div>
        
        <!-- Top Defensores -->
        <div class="top-defenders-box">
          <h4 class="defenders-title">ğŸ† Top Defensores</h4>
          <ul class="defenders-list" id="defendersList">
            <li class="empty-defenders">AÃºn no hay defensores</li>
          </ul>
        </div>
        
        <!-- Total de Duelos -->
        <div class="total-duels-box">
          <div class="duels-label">âš”ï¸ Duelos Totales</div>
          <div class="duels-value" id="totalDuels">0</div>
        </div>
        
        <!-- BotÃ³n Finalizar -->
        <button id="finishBtn" class="btn btn-danger btn-block">
          ğŸ“Š Finalizar Gauntlet
        </button>
      </aside>

      <!-- Arena Principal -->
      <main class="gauntlet-arena">
        
        <!-- Ruleta de Atributos -->
        <div class="attribute-display">
          <div class="attribute-icon">ğŸ°</div>
          <h2 class="attribute-title" id="currentAttribute">Cargando atributo...</h2>
          <p class="attribute-description" id="attributeDescription">DescripciÃ³n</p>
        </div>

        <!-- Batalla -->
        <div class="battle-zone">
          
          <!-- CAMPEÃ“N (Izquierda) -->
          <div class="fighter-container champion-container">
            <div class="fighter-badge champion-badge">
              ğŸ‘‘ CAMPEÃ“N
            </div>
            <div class="fighter-card champion-card" id="championCard">
              <img src="" alt="" class="fighter-image" id="championImage">
              <h3 class="fighter-title" id="championTitle">Cargando...</h3>
              <div class="fighter-streak" id="championStreakBadge">
                ğŸ”¥ Racha: <span id="championStreakValue">0</span>
              </div>
            </div>
            <button class="vote-btn champion-vote-btn" id="voteChampionBtn">
              <span class="vote-icon">ğŸ‘‘</span>
              <span class="vote-text">Voto por el CampeÃ³n</span>
            </button>
          </div>

          <!-- VS Divider -->
          <div class="vs-divider">
            <span class="vs-text">VS</span>
          </div>

          <!-- ASPIRANTE (Derecha) -->
          <div class="fighter-container challenger-container">
            <div class="fighter-badge challenger-badge">
              âš”ï¸ ASPIRANTE
            </div>
            <div class="fighter-card challenger-card" id="challengerCard">
              <img src="" alt="" class="fighter-image" id="challengerImage">
              <h3 class="fighter-title" id="challengerTitle">Cargando...</h3>
              <div class="fighter-info">
                Nuevo Retador
              </div>
            </div>
            <button class="vote-btn challenger-vote-btn" id="voteChallengerBtn">
              <span class="vote-icon">âš”ï¸</span>
              <span class="vote-text">Voto por el Aspirante</span>
            </button>
          </div>

        </div>
        
        <!-- BotÃ³n Empate -->
        <div class="action-center">
          <button id="tieBtn" class="btn btn-secondary btn-tie">
            ğŸ¤ Empate (Re-rotar atributo)
          </button>
        </div>

      </main>

    </div>
  </section>

  <!-- ============================================
       RESULTS SCREEN (Pantalla Final)
       ============================================ -->
  <section id="resultsScreen" class="screen">
    <div class="container">
      
      <h2 class="section-title">ğŸ† AnÃ¡lisis del Gauntlet</h2>

      <!-- Gran CampeÃ³n -->
      <div class="grand-champion-section">
        <h3 class="subsection-title">ğŸ‘‘ Gran CampeÃ³n de la SesiÃ³n</h3>
        <div class="grand-champion-card" id="grandChampionCard">
          <!-- Se llenarÃ¡ dinÃ¡micamente -->
        </div>
      </div>

      <!-- EstadÃ­sticas Generales -->
      <div class="stats-summary">
        <div class="stat-card">
          <div class="stat-icon">âš”ï¸</div>
          <div class="stat-value" id="finalTotalDuels">0</div>
          <div class="stat-label">Duelos Totales</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ¯</div>
          <div class="stat-value" id="finalTotalAnimes">0</div>
          <div class="stat-label">Animes Participantes</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ”¥</div>
          <div class="stat-value" id="finalLongestStreak">0</div>
          <div class="stat-label">Racha MÃ¡s Larga</div>
        </div>
      </div>

      <!-- Top 5 Defensores -->
      <div class="top-defenders-section">
        <h3 class="subsection-title">ğŸ… Top 5 Mejores Defensores</h3>
        <div class="podium-container" id="podiumContainer">
          <!-- Se llenarÃ¡ dinÃ¡micamente -->
        </div>
      </div>

      <!-- Tabla de Atributos Dominantes -->
      <div class="attributes-section">
        <h3 class="subsection-title">ğŸ¯ Atributos MÃ¡s Competidos</h3>
        <div class="attributes-chart" id="attributesChart">
          <!-- Se llenarÃ¡ dinÃ¡micamente -->
        </div>
      </div>

      <!-- Botones de AcciÃ³n -->
      <div class="action-buttons">
        <button id="newGauntletBtn" class="btn btn-primary">
          ğŸ”„ Nuevo Gauntlet
        </button>
        <button id="exportBtn" class="btn btn-success">
          ğŸ’¾ Guardar en Firebase
        </button>
        <button id="shareBtn" class="btn btn-secondary">
          ğŸ“¤ Compartir Resultados
        </button>
      </div>

    </div>
  </section>

  <!-- ============================================
       FOOTER
       ============================================ -->
  <footer class="main-footer">
    <div class="container">
      <p>âœ¨ Hecho por <strong>Jaykai2</strong> | Anime Hub 2025</p>
      <p>ğŸ‘‘ Modo Supervivencia</p>
    </div>
  </footer>

  <!-- ============================================
       SCRIPTS
       ============================================ -->
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  
  <!-- Firebase Config y Services -->
  <script src="../js/firebase-config.js"></script>
  <script src="../js/firebase-service.js"></script>
  
  <!-- Anime Metrics Logic (NUEVO) -->
  <script src="../js/anime-metrics.js"></script>

</body>
</html>